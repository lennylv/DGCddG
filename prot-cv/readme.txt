1. Ecod protein clusters were generated from ECOD distribution file [1,2].

[1] H. Cheng, R. D. Schaeffer, Y. Liao, L. N. Kinch, J. Pei, S. Shi, B. H. Kim, N. V. Grishin. (2014) ECOD: An evolutionary classification of protein domains. PLoS Comput Biol 10(12): e1003926.
[2] H. Cheng, Y. Liao, R. D. Schaeffer, N. V. Grishin. (2015) Manual classification strategies in the ECOD database. Proteins 83(7): 1238-1251.

2. The divided folds of S645 is from GeoPPI project. While the ecod folds of s4169 and s1131 may not be extremly same with the paper since the folds are not available. We simply followed the steps provided by the authors to generate folds of the two datasets. If you get their folds in some way, please email to me and I will do more experiments although my results are bad enough. 
To save time, we use several GPUs to train each fold and save the predicted values:
- python crossvalidation_s4169.py --Fold 1 --dev 0
- python crossvalidation_s4169.py --Fold 2 --dev 1
- python crossvalidation_s4169.py --Fold 3 --dev 2
- python crossvalidation_s4169.py --Fold 4 --dev 3

3. How can we make sure these folds are useful?
3.1 We validate TopGBT and GeoPPI on the S1131 folds generate by us. We obtained the results as follow: 
TopGBT: RMSE ~ 2.31. GeoPPI: rmse ~ 0.235. It is worth noted that GeoPPI authors did not offer the training process. We use the limit hyperparameters provided in the paper. Besides, GeoPPI needs select 100-140 features to make a better performance. Therefore, we use the
sorted_idx.npy of S4169 to achieve this process as this file is provided as the default selected features.

3.2 We further validate TopNetTree and GeoPPI (s4169_geoppi_features.npy is generated with the latest code, the shape is (4169, 1, 240), 240 is default selected feature number in the code) on the S4169 folds and obtained:
 PCC ~ 0.3, rmse ~ 1.70 for TopNetTree, PCC ~ 0.39, rmse ~ 1.63 for GeoPPI. State again: I tried many hyperparameters mentioned in the GeoPPI paper (like N_f, Nestimator, Depth) and obtained the result. These limited parameters may not lead to the best results. I also tried the same parameters under ten-fold Random Split and get rmse ~ 1.28 and  PCC ~ 0.7 for GeoPPI, obtained PCC~0.76 for TopGBT/TopNetTree. Therefore, it can prove the split folds generated by us are useful. It is at least strict as the folds generated by the GeoPPI authors.

3.3 We re-generated S645 folds to further validate our generate ways. The authors provided 4 files for S645: X, Y, sorted_idx.npy, divided-folds.pkl.
We reproduced their results on S645 with these four files, i.e PCC ~ 0.51, as recorded in their paper.
When using our re-generated folds, we got close results, i.e. PCC ~ 0.51.

2023/3/9
4. Here we give the ECOD H-level clusters, it is different from the Supplementary File, however it is really really strict. 
In some cases, TopNetTree (Pearsron) may drop to -0.01 on S1131, 0.2 on S4169. GeoPPI may drop to 0.19 on S4169. If you failed to generate folds
with these clusters, please contact me.

def cluster():
    cluster_dic = {}

    # Core binding factor beta, CBF
    cluster_dic[1] = ['1E50']
    # 4-helical cytokines
    cluster_dic[2] = ['1A22', '1BP3', '1IAR', '3G6D', '3L5X', '3LB6', '3MZG', '3N06', '3N0P', '3NCB', '3NCC', '3S9D', '3SE3', '3SE4',
                    '4I77', '4NKQ', '4RS1']
    # Leucine-rich repeats
    cluster_dic[3] = ['1A4Y', '1N8Z', '1YY9', '1Z7X', '3N85', '4KRL', '4KRO', '4KRP', '4Y61']
    # CI-2 family of serine protease inhibitors
    cluster_dic[4] = ['1ACB', '1CSE', '1SBN', '1SIB', '1TM1', '1TM3', '1TM3', '1TM4', '1TM5', '1TM7', '1TMG', '1TO1', '1Y1K', '1Y33', '1Y34',
                    '1Y3C', '1Y3B', '1Y3D', '1Y48']
    # Immunoglobulin-related
    cluster_dic[5] = ['1AHW', '1DVF', '1JRH', '2U82', '4BFI', '4MYW', '4OFY', '4X4M', '4YFD', '4YH7', '3U82']
    # Retrovirus capsid protein N-terminal domain
    cluster_dic[6] = ['1AK4', '1M9E']
    # MHC antigen-recognition domain
    cluster_dic[7] = ['1AO7', '1BD2', '1LP9', '1MI5', '1OGA', '1QSE', '2AK4', '2BNQ', '2BNR', '2E7L', '2J8U', '2JCC', '2OI9', '2P5E', 
                    '2UWE', '2VLR', '3D3V', '3H9S', '3PWP', '3QDG', '3QDJ', '3QIB', '4FTV', '4JFD', '4JFF', '4L3E', '4MNQ', '4N8V',
                    '4OZG', '4P23', '4P5T', '5E9D', '3C60', '3QFJ','4JFE']
    # Microbial ribonucleases
    cluster_dic[8] = ['1B2S', '1B3S', '1BRS', '1X1W', '1X1X', '1B2U']
    # Snake toxin-like
    cluster_dic[9] = ['1B41', '1FSS', '1KTZ', '1MAH', '1REW', '3BT1']
    # Cystine-knot cytokines
    cluster_dic[10] = ['1BJ1', '1CZ8', '2B0U', '3B4V', '3SEK', '4HSA']
    # Ubiquitin-related
    cluster_dic[11] = ['1C1Y', '1LFD', '1XD3', '2OOB', '2REX', '3KUD', '3M62', '3M63', '3Q3J', '4G0N', '5CXB', '5CYK', '5E6P']
    # UBC-like
    cluster_dic[12] = ['1C4Z', '1S1Q']
    # BPTI-like
    cluster_dic[13] = ['1CBW', '2FTL']
    # Kazal-type serine protease inhibitors
    cluster_dic[14] = ['1CHO', '1CSO', '1CT0', '1CT4', '1CT2', '1PPF', '1R0R', '1SGD', '1SGE', '1SGN', '1SGP', '1SGQ', '1SGY', 
                    '2NU0', '2NU1', '2NU2', '2NU4', '2SGP', '2SGQ', '3HH2', '3SGB']
    # RIFT-related
    cluster_dic[15] = ['1DAN', '1EAW', '1F5R', '1FY8', '1SMF', '2B42', '3BN9', '3BTD', '3BTE', '3BTF', '3BTG', '3BTH', '3BTM', 
                    '3BTT', '3BTQ' ,'3BTW', '3TGK', '3VR6']
    # Lysozyme-like
    cluster_dic[16] = ['1DQJ', '1KIR', '1KIQ', '1KIP', '1MLC', '1VFB', '1XGP', '1XGQ', '1XGU', '1XGT', '1XGR', '1YQV', '2I26',
                    '3HFM']
    # SH3
    cluster_dic[17] = ['1EFN', '1GCQ', '1YCS']
    # His-Me finger endonucleases
    cluster_dic[18] = ['1EMV', '1FR2', '2GYK', '2VLN', '2VLO', '2VLP', '2VLQ', '2WPT', '']
    # Cell-division protein ZipA, C-terminal domain / peptide
    cluster_dic[19] = ['1F47', '3EQS', '3EQY', '3LNZ', '3RF3', '3UIG', '3UII']
    # Bacterial immunoglobulin/albumin-binding domains
    cluster_dic[20] = ['1FC2', '3MZW']
    # Immunoglobulin-binding domains
    cluster_dic[21] = ['1FCC', ]
    # Class I glutamine amidotransferase-like
    cluster_dic[22] = ['1FFW', ]
    # Ribosomal protein L31e/gp120 outer domain
    cluster_dic[23] = ['1GC1', '4JPK']
    # PMP inhibitors
    cluster_dic[24] = ['1GL0', '1GL1']
    # P-loop domains-related
    cluster_dic[25] = ['1GRN', '1GUA', '1K8R', '3EG5', '4EKD', '4GNK', '4PWX', '5TAR', '5XCO', '1E96']
    # Core binding factor beta, CBF
    cluster_dic[26] = ['1H9D', '1HE8']
    # Bacterial enterotoxins
    cluster_dic[27] = ['1JCK', '1SBB', '3W2D']
    # beta-propeller
    cluster_dic[28] = ['1JTD', '1NCA', '1NMB', '3NVN', '3NVQ', '3QHY', '4YEB']
    # a+b domain in beta-lactamase/transpeptidase-like proteins
    cluster_dic[29] = ['1JTG', ]
    # Domain in virus attachment proteins
    cluster_dic[30] = ['1KAC', '2J12', '2J1K']
    # Nuclear receptor coactivator ACTR
    cluster_dic[31] = ['1KBH', ]
    # HAD domain-related
    cluster_dic[32] = ['1MHP', '2B2X']
    # Ecotin, trypsin inhibitor
    cluster_dic[33] = ['1N8O', ]
    # Domain in virus attachment proteins
    cluster_dic[34] = ['1P69', '1P6A']
    # beta-lactamase-inhibitor protein, BLIP
    cluster_dic[35] = ['1S0W', '2G2U', '2G2W']
    # SMAD/FHA domain
    cluster_dic[36] = ['1U7F', ]
    # Inhibitor of vertebrate lysozyme, Ivy
    cluster_dic[37] = ['1UUZ', ]
    # Insulin-like
    cluster_dic[38] = ['1WQJ', '2DSQ']
    # ADP-ribosylation
    cluster_dic[82] = ['2A9K', ]
    # Coronavirus spike protein receptor-binding domain
    cluster_dic[39] = ['2AJF', '4ZS6']
    # EGF-related
    cluster_dic[40] = ['2AJF', '2AW2']
    # Cytochrome c
    cluster_dic[41] = ['2B0Z', '2B10', '2B11', '2B12', '2PCB', '2PCC']
    # IL8-related
    cluster_dic[42] = ['2BDN', ]
    # profilin-like
    cluster_dic[43] = ['2BTF', ]
    # ARM repeat
    cluster_dic[44] = ['2C0L', '3SF4', '4FZA', '4G2V', '4JGH', '4NZW', '4OR7', '4WND', '4O27']
    # Concanavalin A-like
    cluster_dic[45] = ['2C5D', '2HLE', '4L0P', '4RA0']
    # Ankyrin repeat
    cluster_dic[46] = ['2DVW', '3AAA', '4HRN']
    # Efb C-domain-like
    cluster_dic[47] = ['2GOX', '3D5R', '3D5S']
    # Glutathione S-transferase (GST)-C
    cluster_dic[48] = ['2HRK', ]
    # TIMP-like
    cluster_dic[49] = ['2J0T', ]
    # HPr-like
    cluster_dic[50] = ['2JEL', ]
    # SAM/DNA-glycosylase
    cluster_dic[51] = ['2KSO', ]
    # Metalloproteases ("zincins") catalytic domain
    cluster_dic[52] = ['2NYY', '2NZ9', '3KBH']
    # Nuclease A inhibitor (NuiA)-related
    cluster_dic[53] = ['2O3B', ]
    # Subtilisin inhibitor
    cluster_dic[54] = ['2SIC', ]
    # Viral protein domain
    cluster_dic[55] = ['2VIR', '2VIS', '3LZF', '4GXU', '4NM8']
    # Fibronectin type I module-like
    cluster_dic[56] = ['3BK3', ]
    # Glucose permease domain IIB
    cluster_dic[57] = ['3BP8', ]
    # beta-Trefoil
    cluster_dic[58] = ['3BX1', ]
    # Serpins
    cluster_dic[59] = ['3F1S', ]
    # alpha-helical domain in beta-lactamase/transpeptidase-like proteins
    cluster_dic[60] = ['3N4I', ]
    # gp120 inner domain
    cluster_dic[61] = ['3NGB', '3SE8', '3SE9']
    # FMN-binding split barrel
    cluster_dic[62] = ['3NPS', ]
    # Nucleic acid-binding proteins
    cluster_dic[63] = ['3Q8D', ]
    # C-terminal domain in some PLP-dependent transferases
    cluster_dic[64] = ['3R9A', ]
    # Globin-like
    cluster_dic[65] = ['3SZK', ]
    # Carbamate kinase-like
    cluster_dic[66] = ['3WWN', ]
    # FimD N-terminal domain-like
    cluster_dic[67] = ['4B0M', ]
    # omega toxin-related
    cluster_dic[68] = ['4CPA', ]
    # Bifunctional inhibitor/lipid-transfer protein/seed storage 2S albumin/Protein HNS-dependent expression A HdeA
    cluster_dic[69] = ['4CVW', ]
    # bacterioferritin-associated ferredoxin
    cluster_dic[70] = ['4E6K', ]
    # Rap2b (SMA2266)
    cluster_dic[71] = ['4HFK', ]
    # Rossmann-related
    cluster_dic[72] = ['4HRA', ]
    # Hedgehog/intein
    cluster_dic[73] = ['4J2L', ]
    # t-snare proteins
    cluster_dic[74] = ['4JEU', ]
    # Serum albumin-like
    cluster_dic[75] = ['4K71', ]
    # EDD domain
    cluster_dic[76] = ['4LRX', ]
    # Poxvirus L1 protein
    cluster_dic[77] = ['4U6H', ]
    # Viral glycoprotein ectodomain-like
    cluster_dic[78] = ['5C6T', ]
    # Frizzled cysteine-rich domain-related
    cluster_dic[79] = ['5F4E', ]
    # EF-hand-related
    cluster_dic[80] = ['5K39', '5M2O']
    # Chromo domain-like
    cluster_dic[81] = ['5UFQ', '1KNE', '5UFE']
    return cluster_dic
